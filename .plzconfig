[please]
version = 17.27.0

[parse]
preloadsubincludes = ///go//build_defs:go
preloadsubincludes = ///cc//build_defs:cc

[PluginDefinition]
name = solidity

# ============================================================
# CONFIGURATION OPTIONS
# ============================================================

[PluginConfig "forge_tool"]
ConfigKey = ForgeTool
DefaultValue = ~/.foundry/bin/forge
Help = Path or build label for the forge tool. Default assumes Foundry is installed via foundryup.
Inherit = true

[PluginConfig "svm_tool"]
ConfigKey = SvmTool
Help = Build label for the svm binary (from svm() rule). Used by solc() rule to download solc versions.
Optional = true
Inherit = true

[PluginConfig "solc_tool"]
ConfigKey = SolcTool
Help = Build label for solc binary (from solc() rule). When set, sol_contract uses the local solc instead of downloading.
Optional = true
Inherit = true

[PluginConfig "default_solc_version"]
ConfigKey = DefaultSolcVersion
DefaultValue = 0.8.20
Help = Default Solidity compiler version when not specified per-rule
Inherit = true

[PluginConfig "abigen_tool"]
ConfigKey = AbigenTool
Help = Build label for the abigen tool (for Go bindings). If not set, Go bindings will not be generated.
Optional = true
Inherit = true

[PluginConfig "go_ethereum_dep"]
ConfigKey = GoEthereumDep
Help = Build label for go-ethereum dependency (required by generated Go bindings)
Optional = true
Inherit = true

[PluginConfig "please_sol_tool"]
ConfigKey = PleaseSolTool
DefaultValue = //tools/please_sol:please_sol
Help = Build label for the please_sol tool (for import prefix auto-detection)
Inherit = true

[PluginConfig "default_languages"]
ConfigKey = DefaultLanguages
DefaultValue = go
Repeatable = true
Help = Default output languages for sol_contract (currently only 'go' is supported)
Inherit = true

[PluginConfig "optimize"]
ConfigKey = Optimize
DefaultValue = true
Type = bool
Help = Enable Solidity optimizer
Inherit = true

[PluginConfig "optimizer_runs"]
ConfigKey = OptimizerRuns
DefaultValue = 100
Help = Number of optimizer runs
Inherit = true

[PluginConfig "sandbox"]
ConfigKey = Sandbox
DefaultValue = false
Type = bool
Help = Enable sandbox for forge builds. Disabled by default because forge needs access to ~/.svm for solc versions.
Inherit = true

# ============================================================
# TEST CONFIGURATION (for plugin development testing)
# ============================================================

[Plugin "cc"]
Target = //plugins:cc

[Plugin "go"]
Target = //plugins:go
gotool = //third_party/go:gotool|go

[Plugin "solidity"]
SvmTool = //test:svm
AbigenTool = //third_party/go:abigen
GoEthereumDep = //third_party/go:go-ethereum
PleaseSolTool = //tools/please_sol:please_sol
